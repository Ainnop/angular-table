// author: Samuel Mueller 
// homepage: http://github.com/ssmm/angular-table 
// version: 0.0.3 
!function(){angular.module("angular-table",[]),angular.module("angular-table").service("attributeExtractor",function(){return{extractWidth:function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},isSortable:function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},extractTitle:function(t){return t.attr("title")||t.attr("attribute")},extractAttribute:function(t){return t.attr("attribute")}}}),angular.module("angular-table").directive("atTable",["attributeExtractor",function(t){var e,n,r,i,a,l,u,o,c;return r=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""},i=function(e,n){var i,a,l,u,o,c,g,s,f,p,d,m,h,P;for(s=e.find("tr"),a={},P=s.find("th"),p=0,m=P.length;m>p;p++)c=P[p],c=angular.element(c),a[c.attr("attribute")]=c.html();for(s.remove(),s=angular.element("<tr></tr>"),d=0,h=n.length;h>d;d++)o=n[d],o=angular.element(o),i=t.extractAttribute(o),c=angular.element("<th style='cursor: pointer;'></th>"),g=a[i]||r(t.extractTitle(o)),c.html(""+g),u=o[0].attributes.sortable||t.isSortable(o.attr("class")),u&&(c.attr("ng-click","predicate = '"+i+"'; descending = !descending;"),l=angular.element("<i style='margin-left: 10px;'></i>"),l.attr("ng-class","getSortIcon('"+i+"')"),c.append(l)),f=t.extractWidth(o.attr("class")),c.attr("width",f),s.append(c);return e.append(s)},c=function(t){if(t.pagination&&t.list)throw"You can not specify a list if you have specified a pagination. The list defined for the pagnination will automatically be used.";if(!t.pagination&&!t.list)throw"Either a list or pagination must be specified."},o=function(t,e){var n,r;return n=t.find("tbody"),r=n.find("tr"),r.attr("ng-repeat",e),n},u="| orderBy:predicate:descending",l="| limitTo:fromPage() | limitTo:toPage()",n=function(t){this.repeatString="item in "+t.list+" "+u,this.compile=function(t){return o(t,this.repeatString)},this.link=function(){}},e=function(t){var e;if(e=t.sortContext||"global","global"===e)this.repeatString="item in "+t.pagination+".list "+u+" "+l;else{if("page"!==e)throw"Invalid sort-context: "+e+".";this.repeatString="item in "+t.pagination+".list "+l+" "+u+" "}this.compile=function(t,e){var n,r,i,a,l,u,c;if(r=o(t,this.repeatString),"undefined"!=typeof e.fillLastPage){for(l=t.find("td"),a="",u=0,c=l.length;c>u;u++)i=l[u],a+="<td>&nbsp;</td>";return n=angular.element("<tr>"+a+"</tr>"),n.attr("ng-repeat","item in "+e.pagination+".getFillerArray() "),r.append(n)}},this.link=function(e){var n;return n=t.pagination,e.fromPage=function(){return e[n]?e[n].fromPage():void 0},e.toPage=function(){return e[n]?e[n].itemsPerPage:void 0}}},a=function(t){return c(t),t.list?new n(t):t.pagination?new e(t):void 0},{restrict:"AC",scope:!0,compile:function(t,e,n){var r,l,u;return r=a(e),u=t.find("thead"),l=t.find("td"),u[0]&&i(u,l),r.compile(t,e,n),{post:function(t,e,n){return t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},r.link(t,e,n)}}}}}]),angular.module("angular-table").directive("atImplicit",["attributeExtractor",function(t){return{restrict:"AC",compile:function(e){var n;return n=t.extractAttribute(e),e.append("{{item."+n+"}}")}}}]),angular.module("angular-table").directive("atPagination",["attributeExtractor",function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: currentPage <= 0}'>            <a href='' ng-click='goToPage(currentPage - 1)'>&laquo;</a>          </li>          <li ng-class='{active: currentPage == page}' ng-repeat='page in pages'>            <a href='' ng-click='goToPage(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: currentPage >= numberOfPages - 1}'>            <a href='' ng-click='goToPage(currentPage + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",scope:{itemsPerPage:"@",instance:"=",list:"="},link:function(t){return t.instance=t,t.currentPage=0,t.update=function(){var e;return t.currentPage=0,t.list?(t.list.length>0?(t.numberOfPages=Math.ceil(t.list.length/t.itemsPerPage),t.pages=function(){var n,r,i;for(i=[],e=n=0,r=t.numberOfPages-1;r>=0?r>=n:n>=r;e=r>=0?++n:--n)i.push(e);return i}()):(t.numberOfPages=0,t.pages=[]),t.list=t.list):void 0},t.fromPage=function(){return t.list?t.itemsPerPage*t.currentPage-t.list.length:void 0},t.getFillerArray=function(){var e,n,r,i,a,l,u;if(t.currentPage===t.numberOfPages-1){if(n=t.list.length%t.itemsPerPage,0!==n){for(e=t.itemsPerPage-n-1,u=[],r=i=a=t.list.length,l=t.list.length+e;l>=a?l>=i:i>=l;r=l>=a?++i:--i)u.push(r);return u}return[]}},t.goToPage=function(e){return e=Math.max(0,e),e=Math.min(t.numberOfPages-1,e),t.currentPage=e},t.update(),t.$watch("list",function(){return t.update()})}}}])}.call(this);