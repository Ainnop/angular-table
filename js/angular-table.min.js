// author:   Samuel Mueller 
// version:  0.0.8 
// license:  MIT 
// homepage: http://github.com/ssmm/angular-table 
(function(){angular.module("angular-table",[]),angular.module("angular-table").directive("atTable",["metaCollector","setupFactory",function(t,e){var a,n,i;return a=function(t,e){var a,n,i,r,o,u,l,c,g,s,f;for(u=angular.element("<tr></tr>"),l=0,g=e.length;g>l;l++){if(i=e[l],r=angular.element("<th style='cursor: pointer;'></th>"),t[i.attribute]){for(f=t[i.attribute].attributes,c=0,s=f.length;s>c;c++)a=f[c],r.attr(""+a.name,""+a.value);o=t[i.attribute].content}else o=i.title;r.html(""+o),i.sortable&&(r.attr("ng-click","predicate = '"+i.attribute+"'; descending = !descending;"),n=angular.element("<i style='margin-left: 10px;'></i>"),n.attr("ng-class","getSortIcon('"+i.attribute+"')"),r.append(n)),r.attr("width",i.width),u.append(r)}return u},i=function(t){if(t.pagination&&t.atList)throw"You can not specify a list if you have specified a pagination. The list defined for the pagnination will automatically be used.";if(!t.pagination&&!t.atList)throw"Either a list or pagination must be specified."},n=function(t){return t.atPagination?(t.pagination=t.atPagination,t.atPagination=null):void 0},{restrict:"AC",scope:!0,compile:function(r,o,u){var l,c,g,s,f,d;return n(o),i(o),f=r.find("thead"),s=r.find("tbody"),l=t.collectBodyDefinition(s),f[0]&&(c=t.collectCustomHeaderMarkup(f),d=f.find("tr"),d.remove(),f.append(a(c,l.tds))),g=e(o),g.compile(r,o,u),{post:function(t,e,a){return l.initialSorting&&(t.predicate=l.initialSorting.predicate,t.descending="desc"===l.initialSorting.direction),t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},g.link(t,e,a)}}}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t){var e;if(e=t.attr("at-attribute"),!e)throw"at-implicit specified without at-attribute: "+t.html();return t.append("{{item."+e+"}}")}}}]),angular.module("angular-table").directive("atPagination",[function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: currentPage <= 0}'>            <a href='' ng-click='goToPage(currentPage - 1)'>&laquo;</a>          </li>          <li ng-class='{active: currentPage == page}' ng-repeat='page in pages'>            <a href='' ng-click='goToPage(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: currentPage >= numberOfPages - 1}'>            <a href='' ng-click='goToPage(currentPage + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",scope:{atItemsPerPage:"@",atInstance:"=",atList:"="},link:function(t){var e,a;return t.atInstance=t,t.currentPage=0,e=function(e){return e=Math.max(0,e),e=Math.min(t.numberOfPages-1,e)},a=function(){var e;return t.currentPage=0,t.atList?t.atList.length>0?(t.numberOfPages=Math.ceil(t.atList.length/t.atItemsPerPage),t.pages=function(){var a,n,i;for(i=[],e=a=0,n=t.numberOfPages-1;n>=0?n>=a:a>=n;e=n>=0?++a:--a)i.push(e);return i}()):(t.numberOfPages=1,t.pages=[0]):void 0},t.fromPage=function(){return t.atList?t.atItemsPerPage*t.currentPage-t.atList.length:void 0},t.getFillerArray=function(){var e,a,n,i,r,o,u;if(t.currentPage===t.numberOfPages-1){if(a=t.atList.length%t.atItemsPerPage,0!==a||0===t.atList.length){for(e=t.atItemsPerPage-a-1,u=[],n=i=r=t.atList.length,o=t.atList.length+e;o>=r?o>=i:i>=o;n=o>=r?++i:--i)u.push(n);return u}return[]}},t.goToPage=function(a){return t.currentPage=e(a)},a(),t.$watch("atItemsPerPage",function(){return a()}),t.$watch("atList",function(){return a()})}}}]),angular.module("angular-table").service("metaCollector",[function(){var t,e,a,n;return t=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""},e=function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},n=function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},a=function(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw"Invalid value for initial-sorting: "+e+". Allowed values are 'asc' or 'desc'."}return void 0},{collectCustomHeaderMarkup:function(t){var e,a,n,i,r,o,u;for(a={},i=t.find("tr"),u=i.find("th"),r=0,o=u.length;o>r;r++)n=u[r],n=angular.element(n),e=a[n.attr("at-attribute")]={},e.content=n.html(),e.attributes=n[0].attributes;return a},collectBodyDefinition:function(i){var r,o,u,l,c,g,s,f,d,p;for(o={},o.tds=[],o.initialSorting=void 0,p=i.find("td"),f=0,d=p.length;d>f;f++)if(c=p[f],c=angular.element(c),r=c.attr("at-attribute"),g=c.attr("at-title")||t(c.attr("at-attribute")),l=void 0!==c.attr("at-sortable")||n(c.attr("class")),s=e(c.attr("class")),o.tds.push({attribute:r,title:g,sortable:l,width:s}),u=a(c)){if(!r)throw"initial-sorting specified without attribute.";o.initialSorting={},o.initialSorting.direction=u,o.initialSorting.predicate=r}return o}}}]),angular.module("angular-table").factory("setupFactory",[function(){var t,e,a,n,i;return n="| orderBy:predicate:descending",a="| limitTo:fromPage() | limitTo:toPage()",i=function(t,e){var a,n;return a=t.find("tbody"),n=a.find("tr"),n.attr("ng-repeat",e),a},e=function(t){var e;e="item in "+t.atList+" "+n,this.compile=function(t){return i(t,e)},this.link=function(){}},t=function(t){var e,r,o;if(o=t.atSortContext||"global",e=t.pagination,"global"===o)r="item in "+e+".atList "+n+" "+a;else{if("page"!==o)throw"Invalid sort-context: "+o+".";r="item in "+e+".atList "+a+" "+n+" "}this.compile=function(t,a){var n,o,u,l,c,g,s;if(o=i(t,r),"undefined"!=typeof a.atFillLastPage){for(c=t.find("td"),l="",g=0,s=c.length;s>g;g++)u=c[g],l+="<td>&nbsp;</td>";return n=angular.element("<tr>"+l+"</tr>"),n.attr("ng-repeat","item in "+e+".getFillerArray() "),o.append(n)}},this.link=function(t){return t.fromPage=function(){return t[e]?t[e].fromPage():void 0},t.toPage=function(){return t[e]?t[e].atItemsPerPage:void 0}}},function(a){return a.atList?new e(a):a.pagination?new t(a):void 0}}])}).call(this);