// author: Samuel Mueller
// homepage: http://github.com/ssmm/angular-table
!function(){angular.module("angular-table",[]),angular.module("angular-table").service("attributeExtractor",function(){return{extractWidth:function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},isSortable:function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},extractTitle:function(t){return t.attr("title")||t.attr("attribute")},extractAttribute:function(t){return t.attr("attribute")}}}),angular.module("angular-table").directive("atTable",["attributeExtractor",function(t){var e,r;return e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},r=function(r){var a,n,i,u,c,l,s,o,g,b,d,f,p,m,P,h;if(o=r.find("thead"),o[0]){for(b=o.find("tr"),n={},h=b.find("th"),f=0,m=h.length;m>f;f++)s=h[f],s=angular.element(s),n[s.attr("attribute")]=s.html();for(b.remove(),b=$("<tr></tr>"),l=r.find("td"),p=0,P=l.length;P>p;p++)c=l[p],c=angular.element(c),a=t.extractAttribute(c),s=$("<th style='cursor: pointer; -webkit-user-select: none;'></th>"),g=n[a]||e(t.extractTitle(c)),s.html(""+g),u=c[0].attributes.sortable||t.isSortable(c.attr("class")),u&&(s.attr("ng-click","predicate = '"+a+"'; descending = !descending;"),i=angular.element("<i style='margin-left: 10px;'></i>"),i.attr("ng-class","getSortIcon('"+a+"')"),s.append(i)),d=t.extractWidth(c.attr("class")),s.attr("width",d),b.append(s);return o.append(b)}},{restrict:"AC",scope:!0,compile:function(t,e){var a,n,i,u;return n=e.pagination,a=e.list||""+n+".list",r(t),i=t.find("tbody"),u=i.find("tr"),u.attr("ng-repeat","item in "+a+" | limitTo:fromPage() | limitTo:toPage() | orderBy:predicate:descending"),{post:function(t){return t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},t.fromPage=function(){return t[n]?t[n].fromPage():t.list.length},t.toPage=function(){return t[n]?t[n].itemsPerPage:t.list.length}}}}}}]),angular.module("angular-table").directive("atImplicit",["attributeExtractor",function(t){return{restrict:"AC",compile:function(e){var r;return r=t.extractAttribute(e),e.append("{{item."+r+"}}")}}}]),angular.module("angular-table").directive("atPagination",["attributeExtractor",function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: stub.currentPage <= 0}'>            <a href='' ng-click='goToPage(stub.currentPage - 1)'>&laquo;</a>          </li>          <li ng-class='{active: stub.currentPage == page}' ng-repeat='page in pages'>            <a href='' ng-click='goToPage(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: stub.currentPage >= stub.numberOfPages - 1}'>            <a href='' ng-click='goToPage(stub.currentPage + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",scope:{itemsPerPage:"@",instance:"=",list:"="},link:function(t){return t.stub={},t.instance=t.stub,t.stub.list=t.list,t.stub.itemsPerPage=t.itemsPerPage,t.stub.currentPage=0,t.update=function(){var e;return t.stub.numberOfPages=Math.ceil(t.list.length/t.stub.itemsPerPage),t.pages=function(){var r,a,n;for(n=[],e=r=0,a=t.stub.numberOfPages-1;a>=0?a>=r:r>=a;e=a>=0?++r:--r)n.push(e);return n}(),t.stub.list=t.list},t.stub.fromPage=function(){return t.stub.itemsPerPage*t.stub.currentPage-t.list.length},t.goToPage=function(e){return e=Math.max(0,e),e=Math.min(t.stub.numberOfPages-1,e),t.stub.currentPage=e},t.update(),t.$watch("list",function(){return t.update()})}}}])}.call(this);