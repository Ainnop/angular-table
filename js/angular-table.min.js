// author:   Samuel Mueller 
// version:  0.0.8 
// license:  MIT 
// homepage: http://github.com/samu/angular-table 
(function(){var t,e,n,i,r,a,o,s,u,c,l,g={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var i in e)g.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};e=function(){function t(t){this.config_object_name=t,this.items_per_page=""+this.config_object_name+".itemsPerPage",this.sort_context=""+this.config_object_name+".sortContext",this.fill_last_page=""+this.config_object_name+".fillLastPage",this.max_pages=""+this.config_object_name+".maxPages",this.current_page=""+this.config_object_name+".currentPage"}return t}(),r=function(){function t(t,e,n){this.scope=t,this.configuration_variable_names=e,this.list_name=n}return t.prototype.get_list=function(){return this.scope.$eval(this.list_name)},t.prototype.get_items_per_page=function(){return this.scope.$eval(this.configuration_variable_names.items_per_page)||10},t.prototype.get_current_page=function(){return this.scope.$eval(this.configuration_variable_names.current_page)||0},t.prototype.get_max_pages=function(){return this.scope.$eval(this.configuration_variable_names.max_pages)||void 0},t.prototype.get_sort_context=function(){return this.scope.$eval(this.configuration_variable_names.sort_context)||"global"},t.prototype.set_current_page=function(t){return this.scope.$eval(""+this.configuration_variable_names.current_page+"="+t)},t}(),angular.module("angular-table",[]),c="number_of_pages",l="<div style='margin: 0px;'> <ul class='pagination'> <li ng-class='{disabled: get_current_page() <= 0}'> <a href='' ng-click='step_page(-"+c+")'>First</a> </li> <li ng-show='show_sectioning()' ng-class='{disabled: get_current_page() <= 0}'> <a href='' ng-click='jump_back()'>&laquo;</a> </li> <li ng-class='{disabled: get_current_page() <= 0}'> <a href='' ng-click='step_page(-1)'>&lsaquo;</a> </li> <li ng-class='{active: get_current_page() == page}' ng-repeat='page in page_sequence.data'> <a href='' ng-click='go_to_page(page)'>{{page + 1}}</a> </li> <li ng-class='{disabled: get_current_page() >= "+c+" - 1}'> <a href='' ng-click='step_page(1)'>&rsaquo;</a> </li> <li ng-show='show_sectioning()' ng-class='{disabled: get_current_page() >= "+c+" - 1}'> <a href='' ng-click='jump_ahead()'>&raquo;</a> </li> <li ng-class='{disabled: get_current_page() >= "+c+" - 1}'> <a href='' ng-click='step_page("+c+")'>Last</a> </li> </ul> </div>",t=function(){function t(t,e){this.attribute=t.attribute,this.title=t.title,this.sortable=t.sortable,this.width=t.width,this.initialSorting=t.initialSorting,e&&(this.custom_content=e.custom_content,this.attributes=e.attributes)}return t.prototype.create_element=function(){var t;return t=angular.element(document.createElement("th"))},t.prototype.render_title=function(t){return t.html(this.custom_content||this.title)},t.prototype.render_attributes=function(t){var e,n,i,r,a;if(this.custom_content){for(r=this.attributes,a=[],n=0,i=r.length;i>n;n++)e=r[n],a.push(t.attr(e.name,e.value));return a}},t.prototype.render_sorting=function(t){var e;return this.sortable?(t.attr("ng-click","predicate = '"+this.attribute+"'; descending = !descending;"),e=angular.element("<i style='margin-left: 10px;'></i>"),e.attr("ng-class","getSortIcon('"+this.attribute+"', predicate)"),t.append(e)):void 0},t.prototype.render_width=function(t){return t.attr("width",this.width)},t.prototype.render_html=function(){var t;return t=this.create_element(),this.render_title(t),this.render_attributes(t),this.render_sorting(t),this.render_width(t),t},t}(),u=function(){function e(t,e){this.table_element=t,this.attributes=e,this.id=this.attributes.id,this.config=this.attributes.atConfig,this.paginated=null!=this.attributes.atPaginated,this.list=this.attributes.atList,this.create_column_configurations()}return e.prototype.capitaliseFirstLetter=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""},e.prototype.extractWidth=function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},e.prototype.isSortable=function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},e.prototype.getInitialSorting=function(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw"Invalid value for initial-sorting: "+e+". Allowed values are 'asc' or 'desc'."}return void 0},e.prototype.collect_header_markup=function(t){var e,n,i,r,a,o;for(e={},i=t.find("tr"),o=i.find("th"),r=0,a=o.length;a>r;r++)n=o[r],n=angular.element(n),e[n.attr("at-attribute")]={custom_content:n.html(),attributes:n[0].attributes};return e},e.prototype.collect_body_markup=function(t){var e,n,i,r,a,o,s,u,c,l;for(n=[],l=t.find("td"),u=0,c=l.length;c>u;u++)a=l[u],a=angular.element(a),e=a.attr("at-attribute"),o=a.attr("at-title")||this.capitaliseFirstLetter(a.attr("at-attribute")),r=void 0!==a.attr("at-sortable")||this.isSortable(a.attr("class")),s=this.extractWidth(a.attr("class")),i=this.getInitialSorting(a),n.push({attribute:e,title:o,sortable:r,width:s,initialSorting:i});return n},e.prototype.create_column_configurations=function(){var e,n,i,r,a;for(n=this.collect_header_markup(this.table_element),e=this.collect_body_markup(this.table_element),this.column_configurations=[],r=0,a=e.length;a>r;r++)i=e[r],this.column_configurations.push(new t(i,n[i.attribute]));return this.column_configurations},e}(),a=function(){function t(){}return t.prototype.setupTr=function(t,e){var n,i;return n=t.find("tbody"),i=n.find("tr"),i.attr("ng-repeat",e),n},t}(),o=function(t){function e(t,e){this.list=e,this.repeatString="item in "+this.list+" | orderBy:predicate:descending"}return p(e,t),e.prototype.compile=function(t){return this.setupTr(t,this.repeatString)},e.prototype.link=function(){},e}(a),i=function(t){function e(t){this.configuration_variable_names=t,this.repeatString="item in sorted_and_paginated_list"}return p(e,t),e.prototype.compile=function(t){var e,n,i,r,a,o,s;for(n=this.setupTr(t,this.repeatString),a=t.find("td"),r="",o=0,s=a.length;s>o;o++)i=a[o],r+="<td>&nbsp;</td>";e=angular.element(document.createElement("tr")),e.attr("ng-show",this.configuration_variable_names.fill_last_page),e.html(r),e.attr("ng-repeat","item in filler_array"),n.append(e)},e.prototype.link=function(t,e,n,i){var a,o,s,u,l;return a=this.configuration_variable_names,l=new r(t,a,n.atList),s=function(t,e,n,i,r,a,o){var s,u;return t?(u=t,s=n*e-t.length,"global"===i?(u=o("orderBy")(u,r,a),u=o("limitTo")(u,s),u=o("limitTo")(u,n)):(u=o("limitTo")(u,s),u=o("limitTo")(u,n),u=o("orderBy")(u,r,a)),u):[]},o=function(t,e,n,i){var r,a,o,s,u,c,l,g,p,_;if(i=parseInt(i),t.length<=0){for(p=[],o=s=0,c=i-1;c>=0?c>=s:s>=c;o=c>=0?++s:--s)p.push(o);return p}if(e===n-1){if(a=t.length%i,0!==a){for(r=i-a-1,_=[],o=u=l=t.length,g=t.length+r;g>=l?g>=u:u>=g;o=g>=l?++u:--u)_.push(o);return _}return[]}},u=function(){var e;return t.sorted_and_paginated_list=s(l.get_list(),l.get_current_page(),l.get_items_per_page(),l.get_sort_context(),t.predicate,t.descending,i),e=Math.ceil(l.get_list().length/l.get_items_per_page()),t.filler_array=o(l.get_list(),l.get_current_page(),e,l.get_items_per_page())},t.$watch(a.current_page,function(){return u()}),t.$watch(a.items_per_page,function(){return u()}),t.$watch(a.sort_context,function(){return u()}),t.$watch(""+n.atList+".length",function(){return t[c]=Math.ceil(l.get_list().length/l.get_items_per_page()),u()}),t.$watch("predicate",function(){return u()}),t.$watch("descending",function(){return u()})},e}(a),s=function(){function t(t,e,n){this.element=t,this.table_configuration=e,this.configuration_variable_names=n}return t.prototype.constructHeader=function(){var t,e,n,i,r;for(e=angular.element(document.createElement("tr")),r=this.table_configuration.column_configurations,n=0,i=r.length;i>n;n++)t=r[n],e.append(t.render_html());return e},t.prototype.setup_header=function(){var t,e,n;return e=this.element.find("thead"),e?(t=this.constructHeader(),n=angular.element(e).find("tr"),n.remove(),e.append(t)):void 0},t.prototype.get_setup=function(){return this.table_configuration.paginated?new i(this.configuration_variable_names):new o(this.configuration_variable_names,this.table_configuration.list)},t.prototype.compile=function(){return this.setup_header(),this.setup=this.get_setup(),this.setup.compile(this.element)},t.prototype.setup_initial_sorting=function(t){var e,n,i,r,a;for(r=this.table_configuration.column_configurations,a=[],n=0,i=r.length;i>n;n++)if(e=r[n],e.initialSorting){if(!e.attribute)throw"initial-sorting specified without attribute.";t.predicate=e.attribute,a.push(t.descending="desc"===e.initialSorting)}else a.push(void 0);return a},t.prototype.post=function(t,e,n,i){return this.setup_initial_sorting(t),t.getSortIcon||(t.getSortIcon=function(e){return e!==t.predicate?"glyphicon glyphicon-minus":t.descending?"glyphicon glyphicon-chevron-down":"glyphicon glyphicon-chevron-up"}),this.setup.link(t,e,n,i)},t}(),n=function(){function t(t,e,n,i){if(this.lower_bound=null!=t?t:0,this.upper_bound=null!=e?e:1,null==n&&(n=0),this.length=null!=i?i:1,this.length>this.upper_bound-this.lower_bound)throw"sequence is too long";this.data=this.generate(n)}return t.prototype.generate=function(t){var e,n,i,r;for(t>this.upper_bound-this.length?t=this.upper_bound-this.length:t<this.lower_bound&&(t=this.lower_bound),r=[],e=n=t,i=parseInt(t)+parseInt(this.length)-1;i>=t?i>=n:n>=i;e=i>=t?++n:--n)r.push(e);return r},t.prototype.reset_parameters=function(t,e,n){if(this.lower_bound=t,this.upper_bound=e,this.length=n,this.length>this.upper_bound-this.lower_bound)throw"sequence is too long";return this.data=this.generate(this.data[0])},t.prototype.relocate=function(t){var e;return e=this.data[0]+t,this.data=this.generate(e,e+this.length)},t.prototype.realign_greedy=function(t){var e;return t<this.data[0]?(e=t,this.data=this.generate(e)):t>this.data[this.length-1]?(e=t-(this.length-1),this.data=this.generate(e)):void 0},t.prototype.realign_generous=function(){},t}(),angular.module("angular-table").directive("atTable",["$filter",function(t){return{restrict:"AC",scope:!0,compile:function(n,i){var r,a,o;return o=new u(n,i),r=new e(i.atConfig),a=new s(n,o,r),a.compile(),{post:function(e,n,i){return a.post(e,n,i,t)}}}}}]),angular.module("angular-table").directive("atPagination",[function(){return{restrict:"E",scope:!0,replace:!0,template:l,link:function(t,i,a){var o,s,u,l,g,p;return o=new e(a.atConfig),p=new r(t,o,a.atList),u=function(t,e,n){return t=Math.max(e,t),Math.min(n,t)},s=function(){return t[c]},l=function(e){return t[c]=e},g=function(){var e,n;return p.get_list()?p.get_list().length>0?(e=Math.ceil(p.get_list().length/p.get_items_per_page()),l(e),n=t.show_sectioning()?p.get_max_pages():e,t.page_sequence.reset_parameters(0,e,n),p.set_current_page(u(p.get_current_page(),0,s()-1)),t.page_sequence.realign_greedy(p.get_current_page())):(l(1),t.page_sequence.reset_parameters(0,1,1),p.set_current_page(0),t.page_sequence.realign_greedy(0)):void 0},t.show_sectioning=function(){return p.get_max_pages()&&s()>p.get_max_pages()},t.get_current_page=function(){return p.get_current_page()},t.step_page=function(e){return e=parseInt(e),p.set_current_page(u(p.get_current_page()+e,0,s()-1)),t.page_sequence.realign_greedy(p.get_current_page())},t.go_to_page=function(t){return p.set_current_page(t)},t.jump_back=function(){return t.step_page(-p.get_max_pages())},t.jump_ahead=function(){return t.step_page(p.get_max_pages())},t.page_sequence=new n,t.$watch(o.items_per_page,function(){return g()}),t.$watch(o.max_pages,function(){return g()}),t.$watch(a.atList,function(){return g()}),t.$watch(""+a.atList+".length",function(){return g()}),g()}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t){var e;if(e=t.attr("at-attribute"),!e)throw"at-implicit specified without at-attribute: "+t.html();return t.append("{{item."+e+"}}")}}}])}).call(this);