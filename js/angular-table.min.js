// author:   Samuel Mueller 
// version:  0.0.8 
// license:  MIT 
// homepage: http://github.com/samu/angular-table 
(function(){var t,e,i,r,n,a,o={}.hasOwnProperty,s=function(t,e){function i(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};angular.module("angular-table",[]),angular.module("angular-table").directive("atTable",[function(){return{restrict:"AC",scope:!0,compile:function(t,i){var r;return r=new e(t,i),r.compile(),{post:function(t,e,i){return r.post(t,e,i)}}}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t){var e;if(e=t.attr("at-attribute"),!e)throw"at-implicit specified without at-attribute: "+t.html();return t.append("{{item."+e+"}}")}}}]),angular.module("angular-table").directive("atPagination",[function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: currentPage <= 0}'>            <a href='' ng-click='goToPage(currentPage - 1)'>&laquo;</a>          </li>          <li ng-class='{active: currentPage == page}' ng-repeat='page in pages'>            <a href='' ng-click='goToPage(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: currentPage >= numberOfPages - 1}'>            <a href='' ng-click='goToPage(currentPage + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",scope:{atItemsPerPage:"@",atInstance:"=",atList:"="},link:function(t){var e,i;return t.atInstance=t,t.currentPage=0,e=function(e){return e=Math.max(0,e),e=Math.min(t.numberOfPages-1,e)},i=function(){var e;return t.currentPage=0,t.atList?t.atList.length>0?(t.numberOfPages=Math.ceil(t.atList.length/t.atItemsPerPage),t.pages=function(){var i,r,n;for(n=[],e=i=0,r=t.numberOfPages-1;r>=0?r>=i:i>=r;e=r>=0?++i:--i)n.push(e);return n}()):(t.numberOfPages=1,t.pages=[0]):void 0},t.fromPage=function(){return t.atList?t.atItemsPerPage*t.currentPage-t.atList.length:void 0},t.getFillerArray=function(){var e,i,r,n,a,o,s;if(t.currentPage===t.numberOfPages-1){if(i=t.atList.length%t.atItemsPerPage,0!==i||0===t.atList.length){for(e=t.atItemsPerPage-i-1,s=[],r=n=a=t.atList.length,o=t.atList.length+e;o>=a?o>=n:n>=o;r=o>=a?++n:--n)s.push(r);return s}return[]}},t.goToPage=function(i){return t.currentPage=e(i)},i(),t.$watch("atItemsPerPage",function(){return i()}),t.$watch("atList",function(){return i()})}}}]),n=function(){function t(){}return t.prototype.constructHeader=function(){var t,e,i,r,n;for(e=angular.element(document.createElement("tr")),n=this.get_column_configurations(),i=0,r=n.length;r>i;i++)t=n[i],e.append(t.render_html());return e},t.prototype.setup_header=function(){var t,e,i;return e=this.element.find("thead"),e?(t=this.constructHeader(),i=angular.element(e).find("tr"),i.remove(),e.append(t)):void 0},t.prototype.validateInput=function(){if(this.attributes.atPagination&&this.attributes.atList)throw"You can not specify a list if you have specified a Pagination. The list defined for the pagnination will automatically be used.";if(!this.attributes.atPagination&&!this.attributes.atList)throw"Either a list or Pagination must be specified."},t.prototype.create_table_setup=function(t){return t.atList?new r(t):t.atPagination?new i(t):void 0},t.prototype.compile=function(){return this.validateInput(),this.setup_header(),this.setup=this.create_table_setup(this.attributes),this.setup.compile(this.element,this.attributes)},t.prototype.setup_initial_sorting=function(t){var e,i,r,n,a;for(n=this.get_column_configurations(),a=[],i=0,r=n.length;r>i;i++){if(e=n[i],e.initialSorting&&!e.attribute)throw"initial-sorting specified without attribute.";t.predicate=e.attribute,a.push(t.descending="desc"===e.initialSorting)}return a},t.prototype.post=function(t,e,i){return this.setup_initial_sorting(t),t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},this.setup.link(t,e,i)},t}(),a=function(){function t(){}return t.prototype.orderByExpression="| orderBy:predicate:descending",t.prototype.limitToExpression="| limitTo:fromPage() | limitTo:toPage()",t.prototype.setupTr=function(t,e){var i,r;return i=t.find("tbody"),r=i.find("tr"),r.attr("ng-repeat",e),i},t}(),t=function(){function t(t,e){this.attribute=t.attribute,this.title=t.title,this.sortable=t.sortable,this.width=t.width,this.initialSorting=t.initialSorting,e&&(this.custom_content=e.custom_content,this.attributes=e.attributes)}return t.prototype.create_element=function(){var t;return t=angular.element(document.createElement("th")),t.attr("style","cursor: pointer;")},t.prototype.render_title=function(t){return t.html(this.custom_content||this.title)},t.prototype.render_attributes=function(t){var e,i,r,n,a;if(this.custom_content){for(n=this.attributes,a=[],i=0,r=n.length;r>i;i++)e=n[i],a.push(t.attr(e.name,e.value));return a}},t.prototype.render_sorting=function(t){var e;return this.sortable?(t.attr("ng-click","predicate = '"+this.attribute+"'; descending = !descending;"),e=angular.element("<i style='margin-left: 10px;'></i>"),e.attr("ng-class","getSortIcon('"+this.attribute+"')"),t.append(e)):void 0},t.prototype.render_width=function(t){return t.attr("width",this.width)},t.prototype.render_html=function(){var t;return t=this.create_element(),this.render_title(t),this.render_attributes(t),this.render_sorting(t),this.render_width(t),t},t}(),e=function(e){function i(t,e){this.element=t,this.attributes=e}return s(i,e),i.prototype.capitaliseFirstLetter=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""},i.prototype.extractWidth=function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},i.prototype.isSortable=function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},i.prototype.getInitialSorting=function(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw"Invalid value for initial-sorting: "+e+". Allowed values are 'asc' or 'desc'."}return void 0},i.prototype.collect_header_markup=function(t){var e,i,r,n,a,o;for(e={},r=t.find("tr"),o=r.find("th"),n=0,a=o.length;a>n;n++)i=o[n],i=angular.element(i),e[i.attr("at-attribute")]={custom_content:i.html(),attributes:i[0].attributes};return e},i.prototype.collect_body_markup=function(t){var e,i,r,n,a,o,s,u,c,l;for(i=[],l=t.find("td"),u=0,c=l.length;c>u;u++)a=l[u],a=angular.element(a),e=a.attr("at-attribute"),o=a.attr("at-title")||this.capitaliseFirstLetter(a.attr("at-attribute")),n=void 0!==a.attr("at-sortable")||this.isSortable(a.attr("class")),s=this.extractWidth(a.attr("class")),r=this.getInitialSorting(a),i.push({attribute:e,title:o,sortable:n,width:s,initialSorting:r});return i},i.prototype.create_column_configurations=function(){var e,i,r,n,a,o;for(r=this.collect_header_markup(this.element),e=this.collect_body_markup(this.element),i=[],a=0,o=e.length;o>a;a++)n=e[a],i.push(new t(n,r[n.attribute]));return i},i.prototype.get_column_configurations=function(){return this.column_configurations||(this.column_configurations=this.create_column_configurations())},i}(n),r=function(t){function e(t){this.repeatString="item in "+t.atList+" "+this.orderByExpression}return s(e,t),e.prototype.compile=function(t){return this.setupTr(t,this.repeatString)},e.prototype.link=function(){},e}(a),i=function(t){function e(t){if(this.sortContext=t.atSortContext||"global",this.paginationName=t.atPagination,this.fillLastPage=t.atFillLastPage,"global"===this.sortContext)this.repeatString="item in "+this.paginationName+".atList "+this.orderByExpression+" "+this.limitToExpression;else{if("page"!==this.sortContext)throw"Invalid sort-context: "+this.sortContext+".";this.repeatString="item in "+this.paginationName+".atList "+this.limitToExpression+" "+this.orderByExpression+" "}}return s(e,t),e.prototype.compile=function(t){var e,i,r,n,a,o,s;if(i=this.setupTr(t,this.repeatString),"undefined"!=typeof this.fillLastPage){for(a=t.find("td"),n="",o=0,s=a.length;s>o;o++)r=a[o],n+="<td>&nbsp;</td>";e=angular.element(document.createElement("tr")),e.html(n),e.attr("ng-repeat","item in "+this.paginationName+".getFillerArray() "),i.append(e)}},e.prototype.link=function(t){var e;e=this.paginationName,t.fromPage=function(){return t[e]?t[e].fromPage():void 0},t.toPage=function(){return t[e]?t[e].atItemsPerPage:void 0}},e}(a)}).call(this);