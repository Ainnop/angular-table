// author: Samuel Mueller 
// homepage: http://github.com/ssmm/angular-table 
// version: 0.0.1 
!function(){angular.module("angular-table",[]),angular.module("angular-table").service("attributeExtractor",function(){return{extractWidth:function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},isSortable:function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},extractTitle:function(t){return t.attr("title")||t.attr("attribute")},extractAttribute:function(t){return t.attr("attribute")}}}),angular.module("angular-table").directive("atTable",["attributeExtractor",function(t){var e,r,a;return e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},r=function(r){var a,n,i,u,s,c,l,o,g,d,f,b,p,m,P,h;if(o=r.find("thead"),o[0]){for(d=o.find("tr"),n={},h=d.find("th"),b=0,m=h.length;m>b;b++)l=h[b],l=angular.element(l),n[l.attr("attribute")]=l.html();for(d.remove(),d=$("<tr></tr>"),c=r.find("td"),p=0,P=c.length;P>p;p++)s=c[p],s=angular.element(s),a=t.extractAttribute(s),l=$("<th style='cursor: pointer; -webkit-user-select: none;'></th>"),g=n[a]||e(t.extractTitle(s)),l.html(""+g),u=s[0].attributes.sortable||t.isSortable(s.attr("class")),u&&(l.attr("ng-click","predicate = '"+a+"'; descending = !descending;"),i=angular.element("<i style='margin-left: 10px;'></i>"),i.attr("ng-class","getSortIcon('"+a+"')"),l.append(i)),f=t.extractWidth(s.attr("class")),l.attr("width",f),d.append(l);return o.append(d)}},a=function(t){if(t.pagination&&t.list)throw"You can not specify a list if you have specified a pagination. The list defined for the pagnination will automatically be used.";if(!t.pagination&&!t.list)throw"Either a list or pagination must be specified."},{restrict:"AC",scope:!0,compile:function(t,e){var n,i,u,s,c;return a(e),r(t),u=e.pagination,n="",u&&(n="| limitTo:fromPage() | limitTo:toPage()"),i=e.list||""+u+".list",s=t.find("tbody"),c=s.find("tr"),c.attr("ng-repeat","item in "+i+" "+n+" | orderBy:predicate:descending"),{post:function(t){return t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},t.fromPage=function(){return t[u]?t[u].fromPage():void 0},t.toPage=function(){return t[u]?t[u].itemsPerPage:void 0}}}}}}]),angular.module("angular-table").directive("atImplicit",["attributeExtractor",function(t){return{restrict:"AC",compile:function(e){var r;return r=t.extractAttribute(e),e.append("{{item."+r+"}}")}}}]),angular.module("angular-table").directive("atPagination",["attributeExtractor",function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: stub.currentPage <= 0}'>            <a href='' ng-click='goToPage(stub.currentPage - 1)'>&laquo;</a>          </li>          <li ng-class='{active: stub.currentPage == page}' ng-repeat='page in pages'>            <a href='' ng-click='goToPage(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: stub.currentPage >= stub.numberOfPages - 1}'>            <a href='' ng-click='goToPage(stub.currentPage + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",scope:{itemsPerPage:"@",instance:"=",list:"="},link:function(t){return t.stub={},t.instance=t.stub,t.stub.list=t.list,t.stub.itemsPerPage=t.itemsPerPage,t.stub.currentPage=0,t.update=function(){var e;return t.stub.currentPage=0,t.list?(t.list.length>0?(t.stub.numberOfPages=Math.ceil(t.list.length/t.stub.itemsPerPage),t.pages=function(){var r,a,n;for(n=[],e=r=0,a=t.stub.numberOfPages-1;a>=0?a>=r:r>=a;e=a>=0?++r:--r)n.push(e);return n}()):(t.stub.numberOfPages=0,t.pages=[]),t.stub.list=t.list):void 0},t.stub.fromPage=function(){return t.list?t.stub.itemsPerPage*t.stub.currentPage-t.list.length:void 0},t.goToPage=function(e){return e=Math.max(0,e),e=Math.min(t.stub.numberOfPages-1,e),t.stub.currentPage=e},t.update(),t.$watch("list",function(){return t.update()})}}}])}.call(this);