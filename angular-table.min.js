// author: Samuel Mueller 
// homepage: http://github.com/ssmm/angular-table 
!function(){angular.module("angular-table",[]),angular.module("angular-table").service("attributeExtractor",function(){return{extractWidth:function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},isSortable:function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},extractTitle:function(t){return t.attr("title")||t.attr("attribute")},extractAttribute:function(t){return t.attr("attribute")}}}),angular.module("angular-table").directive("atTable",["attributeExtractor",function(t){var e,r;return e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},r=function(r){var a,n,i,u,c,l,o,s,g,d,b,f,p,m,P,h;if(s=r.find("thead"),s[0]){for(d=s.find("tr"),n={},h=d.find("th"),f=0,m=h.length;m>f;f++)o=h[f],o=angular.element(o),n[o.attr("attribute")]=o.html();for(d.remove(),d=$("<tr></tr>"),l=r.find("td"),p=0,P=l.length;P>p;p++)c=l[p],c=angular.element(c),a=t.extractAttribute(c),o=$("<th style='cursor: pointer; -webkit-user-select: none;'></th>"),g=n[a]||e(t.extractTitle(c)),o.html(""+g),u=c[0].attributes.sortable||t.isSortable(c.attr("class")),u&&(o.attr("ng-click","predicate = '"+a+"'; descending = !descending;"),i=angular.element("<i style='margin-left: 10px;'></i>"),i.attr("ng-class","getSortIcon('"+a+"')"),o.append(i)),b=t.extractWidth(c.attr("class")),o.attr("width",b),d.append(o);return s.append(d)}},{restrict:"AC",scope:!0,compile:function(t,e){var a,n,i,u,c;if(r(t),e.pagination&&e.list)throw"List and pagination defined on the same table.";return i=e.pagination,a="",i&&(a="| limitTo:fromPage() | limitTo:toPage()"),n=e.list||""+i+".list",u=t.find("tbody"),c=u.find("tr"),c.attr("ng-repeat","item in "+n+" "+a+" | orderBy:predicate:descending"),{post:function(t){return t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},t.fromPage=function(){return t[i]?t[i].fromPage():void 0},t.toPage=function(){return t[i]?t[i].itemsPerPage:void 0}}}}}}]),angular.module("angular-table").directive("atImplicit",["attributeExtractor",function(t){return{restrict:"AC",compile:function(e){var r;return r=t.extractAttribute(e),e.append("{{item."+r+"}}")}}}]),angular.module("angular-table").directive("atPagination",["attributeExtractor",function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: stub.currentPage <= 0}'>            <a href='' ng-click='goToPage(stub.currentPage - 1)'>&laquo;</a>          </li>          <li ng-class='{active: stub.currentPage == page}' ng-repeat='page in pages'>            <a href='' ng-click='goToPage(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: stub.currentPage >= stub.numberOfPages - 1}'>            <a href='' ng-click='goToPage(stub.currentPage + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",scope:{itemsPerPage:"@",instance:"=",list:"="},link:function(t){return t.stub={},t.instance=t.stub,t.stub.list=t.list,t.stub.itemsPerPage=t.itemsPerPage,t.stub.currentPage=0,t.update=function(){var e;return t.stub.numberOfPages=Math.ceil(t.list.length/t.stub.itemsPerPage),t.pages=function(){var r,a,n;for(n=[],e=r=0,a=t.stub.numberOfPages-1;a>=0?a>=r:r>=a;e=a>=0?++r:--r)n.push(e);return n}(),t.stub.list=t.list},t.stub.fromPage=function(){return t.stub.itemsPerPage*t.stub.currentPage-t.list.length},t.goToPage=function(e){return e=Math.max(0,e),e=Math.min(t.stub.numberOfPages-1,e),t.stub.currentPage=e},t.update(),t.$watch("list",function(){return t.update()}),console.log("pagination loaded!")}}}])}.call(this);