// author:   Samuel Mueller 
// version:  0.0.8 
// license:  MIT 
// homepage: http://github.com/samu/angular-table 
(function(){var t,e,i,n,r,o,a,s,u,l,c,p,g,h,f,_,d,m,b,v,y,w,x={}.hasOwnProperty,S=function(t,e){function i(){this.constructor=t}for(var n in e)x.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};angular.module("angular-table",[]),b="from_page",m="current_page",w="number_of_pages",v="items_per_page",y="list",f="atList",h="atItemsPerPage",p="atFillLastPage",_="atSortContext",c="at-attribute",d="at-sortable",g="at-initial-sorting",l=function(t,e,i){return i?t*e-i.length:void 0},u=function(){function t(){this.table_scope=void 0,this.pagination_scope=void 0,this.list=void 0}return t}(),t=function(){function t(){this.mappings={}}return t.prototype.register_table=function(t){var e,i,n;if(e=(i=this.mappings)[n=t.get_id()]||(i[n]=new u),e.table_configuration=t,e.pagination_scope)throw"WHOOPS"},t.prototype.register_pagination=function(t,e){var i,n;return i=(n=this.mappings)[t]||(n[t]=new u),i.pagination_scope=e,e.$watch("vari",function(){return console.log("it changed lol: ",e.vari)}),i.table_configuration.get_scope().$parent.vari="hello",i.table_configuration?(e[y]=i.table_configuration.get_list(),e.$watch(m,function(){var t;return t=i.table_configuration.get_scope(),t[m]=e[m],t[v]=e[v],t[w]=e[w],t[b]=l(t[v],t[m],t[i.table_configuration.get_list()])})):void 0},t}(),angular.module("angular-table").service("angularTableManager",[function(){return new t}]),angular.module("angular-table").directive("atTable",[function(){return{restrict:"AC",scope:!0,controller:["$scope","$element","$attrs","angularTableManager",function(t,e,i,n){var r;return r=new a(t,i),n.register_table(r)}],compile:function(t,e){var n;return n=new i(t,e),n.compile(),{post:function(t,e,i){return n.post(t,e,i)}}}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(t){var e;if(e=t.attr("at-attribute"),!e)throw"at-implicit specified without at-attribute: "+t.html();return t.append("{{item."+e+"}}")}}}]),angular.module("angular-table").directive("atPagination",[function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: "+m+" <= 0}'>            <a href='' ng-click='go_to_page("+m+" - 1)'>&laquo;</a>          </li>          <li ng-class='{active: "+m+" == page}' ng-repeat='page in pages'>            <a href='' ng-click='go_to_page(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: "+m+" >= "+w+" - 1}'>            <a href='' ng-click='go_to_page("+m+" + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",controller:["$scope","$element","$attrs","angularTableManager",function(t,e,i,n){return n.register_pagination(i.atTableId,t)}],scope:!0,link:function(t,e,i){var n,r,o;return t[v]=i.atItemsPerPage,t[m]=0,n=function(){return t[t[y]]},o=function(){var e;return t[m]=0,n()?n().length>0?(t[w]=Math.ceil(n().length/t[v]),t.pages=function(){var i,n,r;for(r=[],e=i=0,n=t[w]-1;n>=0?n>=i:i>=n;e=n>=0?++i:--i)r.push(e);return r}()):(t[w]=1,t.pages=[0]):void 0},r=function(e){return e=Math.max(0,e),e=Math.min(t[w]-1,e)},t.go_to_page=function(e){return t[m]=r(e)},o(),t.$watch(v,function(){return o()}),t.$watch("atList",function(){return o()})}}}]),o=function(){function t(){}return t.prototype.constructHeader=function(){var t,e,i,n,r;for(e=angular.element(document.createElement("tr")),r=this.get_column_configurations(),i=0,n=r.length;n>i;i++)t=r[i],e.append(t.render_html());return e},t.prototype.setup_header=function(){var t,e,i;return e=this.element.find("thead"),e?(t=this.constructHeader(),i=angular.element(e).find("tr"),i.remove(),e.append(t)):void 0},t.prototype.validateInput=function(){if(!this.attributes.atPagination&&!this.attributes.atList)throw"Either a list or Pagination must be specified."},t.prototype.create_table_setup=function(t){return t.atList&&!t.atPagination?new r(t):t.atList&&t.atPagination?new n(t):void 0},t.prototype.compile=function(){return this.validateInput(),this.setup_header(),this.setup=this.create_table_setup(this.attributes),this.setup.compile(this.element,this.attributes)},t.prototype.setup_initial_sorting=function(t){var e,i,n,r,o;for(r=this.get_column_configurations(),o=[],i=0,n=r.length;n>i;i++){if(e=r[i],e.initialSorting&&!e.attribute)throw"initial-sorting specified without attribute.";t.predicate=e.attribute,o.push(t.descending="desc"===e.initialSorting)}return o},t.prototype.post=function(t,e,i){return this.setup_initial_sorting(t),t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},this.setup.link(t,e,i)},t}(),s=function(){function t(){}return t.prototype.orderByExpression="| orderBy:predicate:descending",t.prototype.limitToExpression="| limitTo:"+b+" | limitTo:"+v,t.prototype.setupTr=function(t,e){var i,n;return i=t.find("tbody"),n=i.find("tr"),n.attr("ng-repeat",e),i},t}(),a=function(){function t(t,e){this.scope=t,this.id=e.id,this.list=e[f],this.fill_last_page=e[p],this.items_per_page=e[h],this.sort_context=e[_]}return t.prototype.get_scope=function(){return this.scope},t.prototype.get_id=function(){return this.id},t.prototype.get_list=function(){return this.list},t.prototype.get_fill_last_page=function(){return this.fill_last_page},t.prototype.get_items_per_page=function(){return this.items_per_page},t.prototype.get_sort_context=function(){return this.sort_context},t}(),new a({},{}),e=function(){function t(t,e){this.attribute=t.attribute,this.title=t.title,this.sortable=t.sortable,this.width=t.width,this.initialSorting=t.initialSorting,e&&(this.custom_content=e.custom_content,this.attributes=e.attributes)}return t.prototype.create_element=function(){var t;return t=angular.element(document.createElement("th")),t.attr("style","cursor: pointer;")},t.prototype.render_title=function(t){return t.html(this.custom_content||this.title)},t.prototype.render_attributes=function(t){var e,i,n,r,o;if(this.custom_content){for(r=this.attributes,o=[],i=0,n=r.length;n>i;i++)e=r[i],o.push(t.attr(e.name,e.value));return o}},t.prototype.render_sorting=function(t){var e;return this.sortable?(t.attr("ng-click","predicate = '"+this.attribute+"'; descending = !descending;"),e=angular.element("<i style='margin-left: 10px;'></i>"),e.attr("ng-class","getSortIcon('"+this.attribute+"')"),t.append(e)):void 0},t.prototype.render_width=function(t){return t.attr("width",this.width)},t.prototype.render_html=function(){var t;return t=this.create_element(),this.render_title(t),this.render_attributes(t),this.render_sorting(t),this.render_width(t),t},t}(),i=function(t){function i(t,e){this.element=t,this.attributes=e}return S(i,t),i.prototype.capitaliseFirstLetter=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""},i.prototype.extractWidth=function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},i.prototype.isSortable=function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},i.prototype.getInitialSorting=function(t){var e;if(e=t.attr("at-initial-sorting")){if("asc"===e||"desc"===e)return e;throw"Invalid value for initial-sorting: "+e+". Allowed values are 'asc' or 'desc'."}return void 0},i.prototype.collect_header_markup=function(t){var e,i,n,r,o,a;for(e={},n=t.find("tr"),a=n.find("th"),r=0,o=a.length;o>r;r++)i=a[r],i=angular.element(i),e[i.attr("at-attribute")]={custom_content:i.html(),attributes:i[0].attributes};return e},i.prototype.collect_body_markup=function(t){var e,i,n,r,o,a,s,u,l,c;for(i=[],c=t.find("td"),u=0,l=c.length;l>u;u++)o=c[u],o=angular.element(o),e=o.attr("at-attribute"),a=o.attr("at-title")||this.capitaliseFirstLetter(o.attr("at-attribute")),r=void 0!==o.attr("at-sortable")||this.isSortable(o.attr("class")),s=this.extractWidth(o.attr("class")),n=this.getInitialSorting(o),i.push({attribute:e,title:a,sortable:r,width:s,initialSorting:n});return i},i.prototype.create_column_configurations=function(){var t,i,n,r,o,a;for(n=this.collect_header_markup(this.element),t=this.collect_body_markup(this.element),i=[],o=0,a=t.length;a>o;o++)r=t[o],i.push(new e(r,n[r.attribute]));return i},i.prototype.get_column_configurations=function(){return this.column_configurations||(this.column_configurations=this.create_column_configurations())},i.prototype.create_table_configuration=function(){},i.prototype.get_table_configuration=function(){},i}(o),r=function(t){function e(t){this.repeatString="item in "+t.atList+" "+this.orderByExpression}return S(e,t),e.prototype.compile=function(t){return this.setupTr(t,this.repeatString)},e.prototype.link=function(){},e}(s),n=function(t){function e(t){this.sortContext=t.atSortContext||"global",this.list_name=t.atList,this.fillLastPage=t.atFillLastPage,this.evaluate_repeat_expression()}return S(e,t),e.prototype.evaluate_repeat_expression=function(){var t;if(t={global:""+this.orderByExpression+" "+this.limitToExpression,page:""+this.limitToExpression+" "+this.orderByExpression}[this.sortContext],!t)throw"Invalid sort-context: "+this.sortContext+".";return this.repeatString="item in "+this.list_name+" "+t},e.prototype.compile=function(t){var e,i,n,r,o,a,s;if(i=this.setupTr(t,this.repeatString),"undefined"!=typeof this.fillLastPage){for(o=t.find("td"),r="",a=0,s=o.length;s>a;a++)n=o[a],r+="<td>&nbsp;</td>";e=angular.element(document.createElement("tr")),e.html(r),e.attr("ng-repeat","item in getFillerArray() "),i.append(e)}},e.prototype.link=function(t){var e;e=this.list_name,t.getFillerArray=function(){var i,n,r,o,a,s,u;if(t[m]===t[w]-1){if(n=t[e].length%t[v],0!==n||0===t[e].length){for(i=t[v]-n-1,u=[],r=o=a=t[e].length,s=t[e].length+i;s>=a?s>=o:o>=s;r=s>=a?++o:--o)u.push(r);return u}return[]}}},e}(s)}).call(this);