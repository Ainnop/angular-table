// author: Samuel Mueller 
// homepage: http://github.com/ssmm/angular-table 
// version: 0.0.2 
!function(){angular.module("angular-table",[]),angular.module("angular-table").service("attributeExtractor",function(){return{extractWidth:function(t){var e;return e=/([0-9]+px)/i.exec(t),e?e[0]:""},isSortable:function(t){var e;return e=/(sortable)/i.exec(t),e?!0:!1},extractTitle:function(t){return t.attr("title")||t.attr("attribute")},extractAttribute:function(t){return t.attr("attribute")}}}),angular.module("angular-table").directive("atTable",["attributeExtractor",function(t){var e,n,r,i,a,u,l;return r=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},i=function(e){var n,i,a,u,l,o,c,g,s,f,d,p,m,h,P,b;if(g=e.find("thead"),g[0]){for(f=g.find("tr"),i={},b=f.find("th"),p=0,h=b.length;h>p;p++)c=b[p],c=angular.element(c),i[c.attr("attribute")]=c.html();for(f.remove(),f=$("<tr></tr>"),o=e.find("td"),m=0,P=o.length;P>m;m++)l=o[m],l=angular.element(l),n=t.extractAttribute(l),c=$("<th style='cursor: pointer; -webkit-user-select: none;'></th>"),s=i[n]||r(t.extractTitle(l)),c.html(""+s),u=l[0].attributes.sortable||t.isSortable(l.attr("class")),u&&(c.attr("ng-click","predicate = '"+n+"'; descending = !descending;"),a=angular.element("<i style='margin-left: 10px;'></i>"),a.attr("ng-class","getSortIcon('"+n+"')"),c.append(a)),d=t.extractWidth(l.attr("class")),c.attr("width",d),f.append(c);return g.append(f)}},l=function(t){if(t.pagination&&t.list)throw"You can not specify a list if you have specified a pagination. The list defined for the pagnination will automatically be used.";if(!t.pagination&&!t.list)throw"Either a list or pagination must be specified."},u=function(t,e){var n,r;return n=t.find("tbody"),r=n.find("tr"),r.attr("ng-repeat",e),n},n=function(t){this.repeatString="item in "+t.list+" | orderBy:predicate:descending",this.compile=function(t){return u(t,this.repeatString)},this.link=function(){}},e=function(t){this.repeatString="item in "+t.pagination+".list | limitTo:fromPage() | limitTo:toPage() | orderBy:predicate:descending",this.compile=function(t,e){var n,r,i,a,l,o,c;if(r=u(t,this.repeatString),"undefined"!=typeof e.fillLastPage){for(l=t.find("td"),a="",o=0,c=l.length;c>o;o++)i=l[o],a+="<td>{{item}}&nbsp;</td>";return n=angular.element("<tr>"+a+"</tr>"),n.attr("ng-repeat","item in "+e.pagination+".getFillerArray() "),r.append(n)}},this.link=function(e){var n;return n=t.pagination,e.fromPage=function(){return e[n]?e[n].fromPage():void 0},e.toPage=function(){return e[n]?e[n].itemsPerPage:void 0}}},a=function(t){return l(t),t.list?new n(t):t.pagination?new e(t):void 0},{restrict:"AC",scope:!0,compile:function(t,e,n){var r;return r=a(e),i(t),r.compile(t,e,n),{post:function(t,e,n){return t.getSortIcon=function(e){return e!==t.predicate?"icon-minus":t.descending?"icon-chevron-down":"icon-chevron-up"},r.link(t,e,n)}}}}}]),angular.module("angular-table").directive("atImplicit",["attributeExtractor",function(t){return{restrict:"AC",compile:function(e){var n;return n=t.extractAttribute(e),e.append("{{item."+n+"}}")}}}]),angular.module("angular-table").directive("atPagination",["attributeExtractor",function(){return{replace:!0,restrict:"E",template:"      <div class='pagination' style='margin: 0px;'>        <ul>          <li ng-class='{disabled: currentPage <= 0}'>            <a href='' ng-click='goToPage(currentPage - 1)'>&laquo;</a>          </li>          <li ng-class='{active: currentPage == page}' ng-repeat='page in pages'>            <a href='' ng-click='goToPage(page)'>{{page + 1}}</a>          </li>          <li ng-class='{disabled: currentPage >= numberOfPages - 1}'>            <a href='' ng-click='goToPage(currentPage + 1); normalize()'>&raquo;</a>          </li>        </ul>      </div>",scope:{itemsPerPage:"@",instance:"=",list:"="},link:function(t){return t.instance=t,t.currentPage=0,t.update=function(){var e;return t.currentPage=0,t.list?(t.list.length>0?(t.numberOfPages=Math.ceil(t.list.length/t.itemsPerPage),t.pages=function(){var n,r,i;for(i=[],e=n=0,r=t.numberOfPages-1;r>=0?r>=n:n>=r;e=r>=0?++n:--n)i.push(e);return i}()):(t.numberOfPages=0,t.pages=[]),t.list=t.list):void 0},t.fromPage=function(){return t.list?t.itemsPerPage*t.currentPage-t.list.length:void 0},t.getFillerArray=function(){var e,n,r,i,a,u,l;if(t.currentPage===t.numberOfPages-1){if(n=t.list.length%t.itemsPerPage,0!==n){for(e=t.itemsPerPage-n-1,l=[],r=i=a=t.list.length,u=t.list.length+e;u>=a?u>=i:i>=u;r=u>=a?++i:--i)l.push(r);return l}return[]}},t.goToPage=function(e){return e=Math.max(0,e),e=Math.min(t.numberOfPages-1,e),t.currentPage=e},t.update(),t.$watch("list",function(){return t.update()})}}}])}.call(this);